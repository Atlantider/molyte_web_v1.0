# ğŸ“¦ Molyte Web ç‰ˆæœ¬ç®¡ç†ç­–ç•¥

## ğŸ¯ ç‰ˆæœ¬ç®¡ç†æ¦‚è¿°

Molyte Web æ”¯æŒå¤šç§éƒ¨ç½²æ–¹å¼ï¼Œä½¿ç”¨ **Git åˆ†æ”¯ + æ ‡ç­¾** ç»„åˆç®¡ç†ä¸åŒç¯å¢ƒçš„ç‰ˆæœ¬ã€‚

---

## ğŸŒ¿ åˆ†æ”¯ç­–ç•¥

### ä¸»è¦åˆ†æ”¯

```
main
â”œâ”€â”€ deploy/campus          # æ ¡å›­ç½‘å•æœºéƒ¨ç½²
â”œâ”€â”€ deploy/tencent         # è…¾è®¯äº‘å•æœºéƒ¨ç½²
â””â”€â”€ deploy/hybrid          # æ··åˆäº‘éƒ¨ç½²ï¼ˆæ ¡å›­ç½‘è®¡ç®— + è…¾è®¯äº‘å‰ç«¯ï¼‰
```

### åˆ†æ”¯è¯´æ˜

#### 1. `main` - ä¸»å¼€å‘åˆ†æ”¯
- **ç”¨é€”**: æ—¥å¸¸å¼€å‘ã€åŠŸèƒ½è¿­ä»£
- **ç‰¹ç‚¹**: æœ€æ–°ä»£ç ï¼Œå¯èƒ½ä¸ç¨³å®š
- **åˆå¹¶**: ä» feature åˆ†æ”¯åˆå¹¶
- **éƒ¨ç½²**: ä¸ç›´æ¥éƒ¨ç½²

#### 2. `deploy/campus` - æ ¡å›­ç½‘éƒ¨ç½²åˆ†æ”¯
- **ç”¨é€”**: æ ¡å›­ç½‘å†…ç½‘å•æœºéƒ¨ç½²
- **ç‰¹ç‚¹**: 
  - æ‰€æœ‰æœåŠ¡è¿è¡Œåœ¨åŒä¸€å°æœåŠ¡å™¨
  - ä½¿ç”¨ SQLite æ•°æ®åº“
  - ä½¿ç”¨ Celery æœ¬åœ°ä»»åŠ¡é˜Ÿåˆ—
  - ä¸éœ€è¦äº‘æœåŠ¡ï¼ˆCOSã€CDN ç­‰ï¼‰
- **é€‚ç”¨åœºæ™¯**: 
  - æ ¡å›­ç½‘å†…éƒ¨ä½¿ç”¨
  - æ— å…¬ç½‘è®¿é—®éœ€æ±‚
  - å°è§„æ¨¡ç”¨æˆ·ï¼ˆ< 50 äººï¼‰

#### 3. `deploy/tencent` - è…¾è®¯äº‘éƒ¨ç½²åˆ†æ”¯
- **ç”¨é€”**: è…¾è®¯äº‘å•æœºéƒ¨ç½²
- **ç‰¹ç‚¹**:
  - æ‰€æœ‰æœåŠ¡è¿è¡Œåœ¨è…¾è®¯äº‘æœåŠ¡å™¨
  - ä½¿ç”¨ PostgreSQL (TencentDB)
  - ä½¿ç”¨ Celery + Redis
  - é›†æˆè…¾è®¯äº‘ COS å­˜å‚¨
- **é€‚ç”¨åœºæ™¯**:
  - å…¬ç½‘è®¿é—®
  - ä¸­ç­‰è§„æ¨¡ç”¨æˆ·ï¼ˆ50-500 äººï¼‰

#### 4. `deploy/hybrid` - æ··åˆäº‘éƒ¨ç½²åˆ†æ”¯ â­ **å½“å‰ç‰ˆæœ¬**
- **ç”¨é€”**: æ ¡å›­ç½‘è®¡ç®— + è…¾è®¯äº‘å‰ç«¯
- **ç‰¹ç‚¹**:
  - å‰ç«¯/åç«¯è¿è¡Œåœ¨è…¾è®¯äº‘ï¼ˆå…¬ç½‘è®¿é—®ï¼‰
  - è®¡ç®—ä»»åŠ¡è¿è¡Œåœ¨æ ¡å›­ç½‘é›†ç¾¤ï¼ˆé«˜æ€§èƒ½ï¼‰
  - ä½¿ç”¨ Polling Worker è½®è¯¢æ¨¡å¼
  - æ™ºèƒ½æ–‡ä»¶ä¸Šä¼ ç­–ç•¥ï¼ˆåªä¸Šä¼ å¿…è¦æ–‡ä»¶ï¼‰
- **é€‚ç”¨åœºæ™¯**:
  - éœ€è¦å…¬ç½‘è®¿é—® + é«˜æ€§èƒ½è®¡ç®—
  - å¤§è§„æ¨¡ç”¨æˆ·ï¼ˆ> 500 äººï¼‰
  - æ¨èç”Ÿäº§ç¯å¢ƒä½¿ç”¨ âœ…

---

## ğŸ·ï¸ æ ‡ç­¾ç­–ç•¥

### æ ‡ç­¾å‘½åè§„èŒƒ

```
v{major}.{minor}.{patch}-{deployment}-{description}

ç¤ºä¾‹:
v1.0.0-campus-initial       # æ ¡å›­ç½‘åˆå§‹ç‰ˆæœ¬
v1.0.0-hybrid-polling       # æ··åˆéƒ¨ç½²è½®è¯¢ç‰ˆæœ¬
v1.1.0-production           # ç”Ÿäº§ç‰ˆæœ¬
v1.1.1-hotfix-security      # å®‰å…¨çƒ­ä¿®å¤
```

### ç‰ˆæœ¬å·è¯´æ˜

- **major**: ä¸»ç‰ˆæœ¬å·ï¼ˆé‡å¤§æ¶æ„å˜æ›´ï¼‰
- **minor**: æ¬¡ç‰ˆæœ¬å·ï¼ˆæ–°åŠŸèƒ½ï¼‰
- **patch**: è¡¥ä¸ç‰ˆæœ¬å·ï¼ˆBug ä¿®å¤ï¼‰
- **deployment**: éƒ¨ç½²æ–¹å¼ï¼ˆcampus/tencent/hybridï¼‰
- **description**: ç®€çŸ­æè¿°

### å½“å‰æ ‡ç­¾

| æ ‡ç­¾ | åˆ†æ”¯ | æ—¥æœŸ | è¯´æ˜ |
|------|------|------|------|
| `v1.0.0-hybrid-polling` | `deploy/hybrid` | 2024-12-01 | æ··åˆäº‘éƒ¨ç½²ï¼Œè½®è¯¢æ¨¡å¼ï¼Œæ™ºèƒ½æ–‡ä»¶ä¸Šä¼  |
| `v1.0.0-campus-initial` | `deploy/campus` | TBD | æ ¡å›­ç½‘å•æœºéƒ¨ç½²åˆå§‹ç‰ˆæœ¬ |

---

## ğŸ“‹ ç‰ˆæœ¬ç®¡ç†å·¥ä½œæµ

### 1. åˆ›å»ºæ–°éƒ¨ç½²åˆ†æ”¯

```bash
# ä» main åˆ›å»ºæ–°çš„éƒ¨ç½²åˆ†æ”¯
git checkout main
git pull origin main
git checkout -b deploy/new-deployment
git push -u origin deploy/new-deployment
```

### 2. æ ‡è®°ç‰ˆæœ¬

```bash
# åœ¨å½“å‰åˆ†æ”¯æ‰“æ ‡ç­¾
git tag -a v1.0.0-hybrid-polling -m "æ··åˆäº‘éƒ¨ç½² - è½®è¯¢æ¨¡å¼
- æ ¡å›­ç½‘é›†ç¾¤è®¡ç®—
- è…¾è®¯äº‘å‰ç«¯/åç«¯
- Polling Worker æ¶æ„
- æ™ºèƒ½æ–‡ä»¶ä¸Šä¼ ç­–ç•¥"

# æ¨é€æ ‡ç­¾åˆ°è¿œç¨‹
git push origin v1.0.0-hybrid-polling
```

### 3. åˆ‡æ¢éƒ¨ç½²ç‰ˆæœ¬

```bash
# æ–¹å¼ 1: åˆ‡æ¢åˆ°åˆ†æ”¯ï¼ˆå¯ç»§ç»­å¼€å‘ï¼‰
git checkout deploy/hybrid
git pull origin deploy/hybrid

# æ–¹å¼ 2: åˆ‡æ¢åˆ°æ ‡ç­¾ï¼ˆåªè¯»ï¼Œç”¨äºå›æ»šï¼‰
git checkout v1.0.0-hybrid-polling
```

### 4. åˆå¹¶æ›´æ–°

```bash
# å°† main çš„æ›´æ–°åˆå¹¶åˆ°éƒ¨ç½²åˆ†æ”¯
git checkout deploy/hybrid
git merge main
git push origin deploy/hybrid

# å¦‚æœæœ‰å†²çªï¼Œè§£å†³åæäº¤
git add .
git commit -m "Merge main into deploy/hybrid"
git push origin deploy/hybrid
```

---

## ğŸš€ éƒ¨ç½²æµç¨‹

### æ ¡å›­ç½‘é›†ç¾¤éƒ¨ç½²

```bash
# 1. å…‹éš†ä»“åº“
git clone https://github.com/Atlantider/molyte_web_v1.0.git
cd molyte_web_v1.0

# 2. åˆ‡æ¢åˆ°æ··åˆéƒ¨ç½²åˆ†æ”¯
git checkout deploy/hybrid

# 3. é…ç½®ç¯å¢ƒ
cp deployment/polling_worker_config_tencent.yaml.template \
   deployment/polling_worker_config_tencent.yaml
vim deployment/polling_worker_config_tencent.yaml

# 4. å¯åŠ¨ Worker
bash deployment/start_polling_worker.sh tencent
```

### è…¾è®¯äº‘æœåŠ¡å™¨éƒ¨ç½²

```bash
# 1. å…‹éš†ä»“åº“
git clone https://github.com/Atlantider/molyte_web_v1.0.git
cd molyte_web_v1.0

# 2. åˆ‡æ¢åˆ°æ··åˆéƒ¨ç½²åˆ†æ”¯
git checkout deploy/hybrid

# 3. é…ç½®ç¯å¢ƒ
cp backend/.env.template backend/.env
vim backend/.env

# 4. å¯åŠ¨æœåŠ¡
bash scripts/start_all.sh
```

---

## ğŸ“Š ç‰ˆæœ¬å¯¹æ¯”

### åŠŸèƒ½å¯¹æ¯”è¡¨

| åŠŸèƒ½ | Campus | Tencent | Hybrid â­ |
|------|--------|---------|----------|
| **å…¬ç½‘è®¿é—®** | âŒ | âœ… | âœ… |
| **é«˜æ€§èƒ½è®¡ç®—** | âš ï¸ æœ‰é™ | âŒ | âœ… |
| **äº‘å­˜å‚¨** | âŒ | âœ… | âœ… |
| **å¯æ‰©å±•æ€§** | â­ | â­â­ | â­â­â­ |
| **æˆæœ¬** | ä½ | ä¸­ | ä¸­ |
| **éƒ¨ç½²å¤æ‚åº¦** | ç®€å• | ç®€å• | ä¸­ç­‰ |
| **æ¨èåœºæ™¯** | å†…ç½‘æµ‹è¯• | å°è§„æ¨¡ç”Ÿäº§ | å¤§è§„æ¨¡ç”Ÿäº§ |

### æ¶æ„å¯¹æ¯”

#### Campus æ¶æ„
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   æ ¡å›­ç½‘æœåŠ¡å™¨               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Frontendâ”‚  â”‚ Backend  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ SQLite  â”‚  â”‚ Celery   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ LAMMPS / Gaussian       â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### Tencent æ¶æ„
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   è…¾è®¯äº‘æœåŠ¡å™¨               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Frontendâ”‚  â”‚ Backend  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚PostgreSQLâ”‚ â”‚ Redis    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Celery  â”‚  â”‚ COS      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### Hybrid æ¶æ„ â­
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   è…¾è®¯äº‘æœåŠ¡å™¨               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Frontendâ”‚  â”‚ Backend  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚PostgreSQLâ”‚ â”‚ COS      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†• HTTPS API
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   æ ¡å›­ç½‘é›†ç¾¤                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ Polling Worker          â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ LAMMPS / Gaussian       â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ ç‰ˆæœ¬å‡çº§ç­–ç•¥

### ä» Campus å‡çº§åˆ° Hybrid

```bash
# 1. å¤‡ä»½æ•°æ®
cp molyte.db molyte.db.backup

# 2. å¯¼å‡ºæ•°æ®
python scripts/export_data.py

# 3. åˆ‡æ¢åˆ†æ”¯
git checkout deploy/hybrid

# 4. å¯¼å…¥æ•°æ®åˆ°è…¾è®¯äº‘
python scripts/import_data.py

# 5. é…ç½® Polling Worker
cp deployment/polling_worker_config_tencent.yaml.template \
   deployment/polling_worker_config_tencent.yaml
vim deployment/polling_worker_config_tencent.yaml

# 6. å¯åŠ¨æœåŠ¡
bash deployment/start_polling_worker.sh tencent
```

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [æ··åˆäº‘éƒ¨ç½²æŒ‡å—](./CAMPUS_WORKER_DEPLOYMENT.md)
- [è…¾è®¯äº‘éƒ¨ç½²æŒ‡å—](./TENCENT_CLOUD_DEPLOYMENT_GUIDE.md)
- [å®‰å…¨é…ç½®æŒ‡å—](./SECURITY_GUIDE.md)
- [ä»£ç åŒæ­¥å·¥å…·](./sync_code.sh)

---

## ğŸ†˜ å¸¸è§é—®é¢˜

### Q: å¦‚ä½•æŸ¥çœ‹å½“å‰ç‰ˆæœ¬ï¼Ÿ

```bash
# æŸ¥çœ‹å½“å‰åˆ†æ”¯
git branch

# æŸ¥çœ‹å½“å‰æ ‡ç­¾
git describe --tags

# æŸ¥çœ‹æ‰€æœ‰æ ‡ç­¾
git tag -l
```

### Q: å¦‚ä½•å›æ»šåˆ°ä¹‹å‰çš„ç‰ˆæœ¬ï¼Ÿ

```bash
# å›æ»šåˆ°ç‰¹å®šæ ‡ç­¾
git checkout v1.0.0-hybrid-polling

# å¦‚æœéœ€è¦åŸºäºæ­¤ç‰ˆæœ¬ç»§ç»­å¼€å‘
git checkout -b hotfix/v1.0.0 v1.0.0-hybrid-polling
```

### Q: å¦‚ä½•åœ¨ä¸åŒéƒ¨ç½²æ–¹å¼ä¹‹é—´åˆ‡æ¢ï¼Ÿ

```bash
# åˆ‡æ¢åˆ°æ ¡å›­ç½‘éƒ¨ç½²
git checkout deploy/campus

# åˆ‡æ¢åˆ°æ··åˆéƒ¨ç½²
git checkout deploy/hybrid

# åˆ‡æ¢åˆ°è…¾è®¯äº‘éƒ¨ç½²
git checkout deploy/tencent
```

---

**æœ€åæ›´æ–°**: 2024-12-01  
**ç»´æŠ¤è€…**: xiaoji

